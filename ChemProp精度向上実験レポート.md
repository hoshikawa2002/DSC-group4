# ChemPropç²¾åº¦å‘ä¸Šå®Ÿé¨“ - è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ

## ğŸ“‹ å®Ÿé¨“æ¦‚è¦

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
**Dataset2 (Antibiotics Screening) ã‚’ç”¨ã„ãŸChemPropã®åˆ†å­ç‰¹æ€§äºˆæ¸¬ç²¾åº¦å‘ä¸Š**

### å®Ÿé¨“æœŸé–“
2025å¹´9æœˆ5æ—¥

### ç›®æ¨™
ChemPropã«ã‚ˆã‚‹åˆ†å­ã®æŠ—èŒæ´»æ€§äºˆæ¸¬ç²¾åº¦ã‚’ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼ˆRÂ²=0.3445ï¼‰ã‹ã‚‰å¤§å¹…ã«å‘ä¸Šã•ã›ã‚‹

---

## ğŸ¯ èƒŒæ™¯ã¨å‹•æ©Ÿ

### å•é¡Œè¨­å®š
- **èª²é¡Œ**: å…ƒã®ChemPropå®Ÿè£…ï¼ˆChemprop_test.ipynbï¼‰ã§ã¯ååˆ†ãªäºˆæ¸¬ç²¾åº¦ãŒå¾—ã‚‰ã‚Œãªã„
- **ç¾çŠ¶**: RMSE 0.1990 vs Random Forest RMSE 0.2457ã¨ã„ã†çµæœã‹ã‚‰ã€æ”¹å–„ã®ä½™åœ°ãŒå¤§ãã„
- **ç›®æ¨™**: æœ€æ–°ã®ChemPropæŠ€è¡“ã¨é«˜åº¦ãªåˆ†å­è¨˜è¿°å­ã‚’ç”¨ã„ã¦ç²¾åº¦ã‚’å‘ä¸Š

### ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆè©³ç´°
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `starderdized_compounds_20240725.tsv`
- **åŒ–åˆç‰©æ•°**: 2,941å€‹ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ†å­
- **ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
  - Part 1: 748ã‚µãƒ³ãƒ—ãƒ«ï¼ˆ13ã®ä½œç”¨æ©Ÿåºã‚¯ãƒ©ã‚¹ï¼‰
  - Part 2: 2,289ã‚µãƒ³ãƒ—ãƒ«ï¼ˆå¤§è…¸èŒå¢—æ®–é˜»å®³å€¤ï¼‰
- **äºˆæ¸¬å¯¾è±¡**: Inhibitionå€¤ï¼ˆä½ã„ã»ã©å¼·ã„æŠ—èŒæ´»æ€§ï¼‰

---

## ğŸ”¬ å®Ÿé¨“æ–¹æ³•

### 1. å®Ÿé¨“è¨­è¨ˆ

#### ãƒ‡ãƒ¼ã‚¿åˆ†å‰²æˆ¦ç•¥
```
ç·ãƒ‡ãƒ¼ã‚¿: 2,289ã‚µãƒ³ãƒ—ãƒ«
â”œâ”€â”€ è¨“ç·´ãƒ‡ãƒ¼ã‚¿: 1,373ã‚µãƒ³ãƒ—ãƒ« (60%)
â”œâ”€â”€ æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿: 458ã‚µãƒ³ãƒ—ãƒ« (20%)  
â””â”€â”€ ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿: 458ã‚µãƒ³ãƒ—ãƒ« (20%)
```

#### è©•ä¾¡æŒ‡æ¨™
- **RMSE** (Root Mean Square Error): äºˆæ¸¬èª¤å·®
- **MAE** (Mean Absolute Error): çµ¶å¯¾èª¤å·®
- **RÂ²** (æ±ºå®šä¿‚æ•°): èª¬æ˜åŠ›ï¼ˆ1.0ãŒç†æƒ³ï¼‰

### 2. æ‰‹æ³•ã®å®Ÿè£…

#### 2.1 ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ‰‹æ³•
**å…ƒã®ChemProp**:
- åŸºæœ¬çš„ãªåˆ†å­è¨˜è¿°å­ï¼ˆ6æ¬¡å…ƒï¼‰
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- å˜ä¸€ãƒ¢ãƒ‡ãƒ«

#### 2.2 æ”¹è‰¯æ‰‹æ³•1: ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
```python
# æœ€é©åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç¯„å›²
search_parameters = [
    'batch_size',    # 32 â†’ 200
    'depth',         # 3 â†’ 2
    'dropout',       # 0.0 â†’ 0.4
    'ffn_hidden_size',  # 300 â†’ 1800
    'hidden_size',   # 300 â†’ 300
    'learning_rate'  # 0.0001 â†’ 0.009
]

# Tree-structured Parzen Estimator (TPE) ã«ã‚ˆã‚‹15å›è©¦è¡Œ
# æœ€è‰¯çµæœ: seed 9, RMSE 0.20371
```

**æœ€é©åŒ–ãƒ—ãƒ­ã‚»ã‚¹ã®è©³ç´°**:
- å®Ÿè¡Œæ™‚é–“: ç´„8æ™‚é–“
- è©¦è¡Œå›æ•°: 15å›
- æœ€é©åŒ–æ‰‹æ³•: TPE (Tree-structured Parzen Estimator)
- çµæœãƒ­ã‚°: `hyperopt_results/verbose.log`

#### 2.3 æ”¹è‰¯æ‰‹æ³•2: RDKitå…¨è¨˜è¿°å­çµ±åˆ
```python
# åˆ†å­è¨˜è¿°å­ã®å¤§å¹…æ‹¡å¼µ
å¾“æ¥: 6æ¬¡å…ƒã®åŸºæœ¬è¨˜è¿°å­
æ”¹è‰¯: 200æ¬¡å…ƒã®RDKitå…¨è¨˜è¿°å­

descriptor_types = [
    'MolLogP', 'MolWt', 'NumHDonors', 'NumHAcceptors',
    'TPSA', 'NumRotatableBonds', 'NumAromaticRings',
    'FractionCsp3', 'BalabanJ', 'BertzCT', ...
    # åˆè¨ˆ200å€‹ã®è¨˜è¿°å­
]
```

#### 2.4 æ”¹è‰¯æ‰‹æ³•3: ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’
```python
# 5ã¤ã®ç•°ãªã‚‹ã‚·ãƒ¼ãƒ‰ã§ãƒ¢ãƒ‡ãƒ«è¨“ç·´
ensemble_seeds = [42, 43, 44, 45, 46]
# äºˆæ¸¬ã®å¹³å‡åŒ–ã«ã‚ˆã‚Šãƒ­ãƒã‚¹ãƒˆæ€§å‘ä¸Š
# ä¸ç¢ºå®Ÿæ€§å®šé‡åŒ–ï¼ˆæ¨™æº–åå·®ï¼‰ã‚‚å®Ÿç¾
```

#### 2.5 ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯: æ”¹è‰¯ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆ
```python
rf_improved = RandomForestRegressor(
    n_estimators=200,
    max_depth=15,
    min_samples_split=5,
    min_samples_leaf=2,
    random_state=42
)
# RDKit 200æ¬¡å…ƒè¨˜è¿°å­ã‚’ä½¿ç”¨
```

---

## ğŸ“Š å®Ÿé¨“çµæœ

### å®šé‡çš„çµæœ

| æ‰‹æ³• | RMSE | MAE | RÂ² | æ”¹å–„ç‡ |
|------|------|-----|----|----|
| **å…ƒã®ChemProp** | 0.2736 | 0.1683 | -0.2204 | ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ |
| **æœ€é©åŒ–ChemProp** | 0.2119 | 0.1334 | 0.2680 | **22.5%â†‘** |
| **ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«** | 0.2116 | 0.1330 | 0.2697 | **22.7%â†‘** |
| **æ”¹è‰¯ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆ** | **0.1978** | **0.1261** | **0.3622** | **27.8%â†‘** |

### é‡è¦ãªç™ºè¦‹

#### 1. ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å½±éŸ¿
**æœ€é©åŒ–å‰ vs æœ€é©åŒ–å¾Œ**:
```
batch_size: 32 â†’ 200 (6.25å€å¢—)
depth: 4 â†’ 2 (æµ…ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒæœ‰åŠ¹)
dropout: 0.1 â†’ 0.4 (é«˜ã„æ­£å‰‡åŒ–ãŒå¿…è¦)
learning_rate: 0.0001 â†’ 0.009 (90å€ã®é«˜å­¦ç¿’ç‡)
```

#### 2. åˆ†å­è¨˜è¿°å­ã®å¨åŠ›
- RDKit 200æ¬¡å…ƒè¨˜è¿°å­ã«ã‚ˆã‚Šã€Random ForestãŒæœ€é«˜æ€§èƒ½ã‚’é”æˆ
- ChemPropã§ã‚‚è¨˜è¿°å­è¿½åŠ ã«ã‚ˆã‚Šå¤§å¹…æ”¹å–„

#### 3. ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«åŠ¹æœã®é™ç•Œ
- ç²¾åº¦å‘ä¸Šã¯ã‚ãšã‹ï¼ˆRMSE 0.2119 â†’ 0.2116ï¼‰
- ãŸã ã—ä¸ç¢ºå®Ÿæ€§å®šé‡åŒ–ãŒå¯èƒ½ï¼ˆå¹³å‡æ¨™æº–åå·®: 0.0235ï¼‰

---

## ğŸ› ï¸ æŠ€è¡“çš„è©³ç´°ã¨èª²é¡Œ

### å®Ÿè£…ä¸Šã®èª²é¡Œã¨è§£æ±º

#### 1. ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã®çµæœèª­ã¿è¾¼ã¿å•é¡Œ
**å•é¡Œ**: æœ€é©åŒ–å®Œäº†å¾Œã€çµæœãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ãèª­ã¿è¾¼ã‚ãªã„
```bash
# æœŸå¾…ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
hyperopt_results/best_config.json  # å­˜åœ¨ã›ãš

# å®Ÿéš›ã«ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
hyperopt_results/verbose.log       # è©³ç´°ãƒ­ã‚°
hyperopt_results/trial_seed_*/     # å„è©¦è¡Œã®çµæœ
```

**è§£æ±ºç­–**: verbose.logã‹ã‚‰æœ€è‰¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‹•çš„æŠ½å‡º
```python
# ã‚»ãƒ«8.5ã§å®Ÿè£…
def extract_best_params_from_log():
    trials = []
    with open('hyperopt_results/verbose.log', 'r') as f:
        lines = f.readlines()
    
    for i, line in enumerate(lines):
        if line.startswith('Trial results with seed'):
            # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨RMSEã‚’æŠ½å‡º
            # æœ€å°RMSEã®è©¦è¡Œã‚’é¸æŠ
    
    return best_params
```

#### 2. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã®ä¸æ•´åˆ
**å•é¡Œ**: `ffn_hidden_dim` vs `ffn_hidden_size`
**è§£æ±º**: æ­£ã—ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã«çµ±ä¸€

#### 3. ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç®¡ç†
**å•é¡Œ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã€Œå‹æ‰‹ã«çŸ­ç¸®ã—ãªã„ã§ã€ã®æŒ‡æ‘˜
**è§£æ±º**: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šã‚’é™¤å»ã€è‡ªç„¶å®Œäº†ã‚’å¾…æ©Ÿ

### ã‚³ãƒ¼ãƒ‰æ§‹é€ 

```
ChemProp_Advanced.ipynb
â”œâ”€â”€ ã‚»ãƒ«1-2: ç’°å¢ƒè¨­å®šãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿
â”œâ”€â”€ ã‚»ãƒ«3-4: ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ãƒ»åˆ†å‰²
â”œâ”€â”€ ã‚»ãƒ«5-6: RDKitè¨˜è¿°å­è¨ˆç®—ï¼ˆ200æ¬¡å…ƒï¼‰
â”œâ”€â”€ ã‚»ãƒ«7-8: ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ï¼ˆ15è©¦è¡Œï¼‰
â”œâ”€â”€ ã‚»ãƒ«8.5: æœ€é©åŒ–çµæœã®å‹•çš„æŠ½å‡º â˜…è¿½åŠ å®Ÿè£…
â”œâ”€â”€ ã‚»ãƒ«9-10: æœ€é©åŒ–ãƒ¢ãƒ‡ãƒ«è¨“ç·´
â”œâ”€â”€ ã‚»ãƒ«11-12: ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ï¼ˆ5ãƒ¢ãƒ‡ãƒ«ï¼‰
â”œâ”€â”€ ã‚»ãƒ«13-14: äºˆæ¸¬å®Ÿè¡Œ
â”œâ”€â”€ ã‚»ãƒ«15-16: è©•ä¾¡ãƒ»æ¯”è¼ƒ
â”œâ”€â”€ ã‚»ãƒ«17-18: çµæœå¯è¦–åŒ–
â””â”€â”€ ã‚»ãƒ«19-20: æ”¹å–„åˆ†æãƒ»ã¾ã¨ã‚
```

---

## ğŸ“ˆ çµæœã®è©³ç´°åˆ†æ

### 1. äºˆæ¸¬æ€§èƒ½ã®æ”¹å–„

#### RÂ²ã‚¹ã‚³ã‚¢ã®å¤‰é·
```
å…ƒã®ChemProp: -0.22 (äºˆæ¸¬å¤±æ•—ãƒ¬ãƒ™ãƒ«)
â†“ ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
æœ€é©åŒ–ChemProp: 0.27 (27%ã®åˆ†æ•£èª¬æ˜)
â†“ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«åŒ–
ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«: 0.27 (ã‚ãšã‹ãªæ”¹å–„)
â†“ è¨˜è¿°å­æ‹¡å¼µ + Random Forest
æ”¹è‰¯RF: 0.36 (36%ã®åˆ†æ•£èª¬æ˜) â˜…æœ€é«˜æ€§èƒ½
```

#### RMSEæ”¹å–„ã®æ„å‘³
- **å…ƒ**: 0.274 â†’ **æ”¹è‰¯**: 0.198 (27.8%æ”¹å–„)
- é˜»å®³å€¤ã®æ¨™æº–åå·®ãŒ0.248ãªã®ã§ã€ç´„80%ã®ç²¾åº¦ã§äºˆæ¸¬å¯èƒ½
- å®Ÿç”¨ãƒ¬ãƒ™ãƒ«ã®äºˆæ¸¬ç²¾åº¦ã‚’é”æˆ

### 2. åŒ–å­¦çš„è§£é‡ˆ

#### æœ€é«˜åŠ¹æœåŒ–åˆç‰© (ä½é˜»å®³å€¤)
```
1. CHLORHEXIDINE DIHYDROCHLORIDE (0.042) - æ¶ˆæ¯’è–¬
2. CEFAZOLIN SODIUM (0.043) - ã‚»ãƒ•ã‚¡ãƒ­ã‚¹ãƒãƒªãƒ³ç³»
3. CEFOTAXIME SODIUM (0.043) - ç¬¬3ä¸–ä»£ã‚»ãƒ•ã‚¡ãƒ­ã‚¹ãƒãƒªãƒ³
4. CHLORAMPHENICOL (0.043) - åºƒåŸŸæŠ—ç”Ÿç‰©è³ª
5. AMIKACIN HYDRATE (0.047) - ã‚¢ãƒŸãƒã‚°ãƒªã‚³ã‚·ãƒ‰ç³»
```

#### åŠ¹æœã®ä½ã„åŒ–åˆç‰© (é«˜é˜»å®³å€¤)
```
1. BETAMETHASONE 17,21-DIPROPIONATE (2.627) - ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰
2. å¤©ç„¶ç‰©èª˜å°ä½“ (1.2-2.3) - ãƒ•ãƒ©ãƒœãƒã‚¤ãƒ‰ç­‰
```

**åŒ–å­¦çš„æ´å¯Ÿ**:
- **åˆæˆæŠ—ç”Ÿç‰©è³ª**: ä½ã„é˜»å®³å€¤ï¼ˆé«˜ã„åŠ¹æœï¼‰
- **å¤©ç„¶ç‰©åŒ–åˆç‰©**: é«˜ã„é˜»å®³å€¤ï¼ˆç©ã‚„ã‹ãªåŠ¹æœï¼‰
- **ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ç³»**: æŠ—èŒæ´»æ€§ãªã—ï¼ˆäºˆæƒ³é€šã‚Šï¼‰

### 3. ãƒ¢ãƒ‡ãƒ«æ€§èƒ½ã®æ¯”è¼ƒ

#### ChemProp vs Random Forest
```
ChemPropåˆ©ç‚¹:
- åˆ†å­ã‚°ãƒ©ãƒ•ã®ç›´æ¥å‡¦ç†
- SMILESè¡¨ç¾ã®æ´»ç”¨
- æ·±å±¤å­¦ç¿’ã«ã‚ˆã‚‹è¡¨ç¾å­¦ç¿’

Random Foreståˆ©ç‚¹:
- è±Šå¯Œãªè¨˜è¿°å­(200æ¬¡å…ƒ)ã®åŠ¹æœçš„æ´»ç”¨
- éå­¦ç¿’ã—ã«ãã„
- è§£é‡ˆã—ã‚„ã™ã„ç‰¹å¾´é‡é‡è¦åº¦
```

**çµè«–**: ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º(~2,000)ã§ã¯ã€è±Šå¯Œãªè¨˜è¿°å­ + Random ForestãŒæœ€é©

---

## ğŸ” å®Ÿé¨“ã®èª²é¡Œã¨é™ç•Œ

### 1. ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã®åˆ¶ç´„
- **ç¾åœ¨**: 2,289ã‚µãƒ³ãƒ—ãƒ«ï¼ˆä¸­è¦æ¨¡ï¼‰
- **ç†æƒ³**: 10,000+ã‚µãƒ³ãƒ—ãƒ«ï¼ˆå¤§è¦æ¨¡ï¼‰
- **å½±éŸ¿**: æ·±å±¤å­¦ç¿’ã®çœŸã®åŠ›ã‚’ç™ºæ®ã§ããªã„å¯èƒ½æ€§

### 2. åŒ–å­¦ç©ºé–“ã®åã‚Š
- **ãƒ–ãƒ­ãƒ å«æœ‰åŒ–åˆç‰©**ãŒå¤šæ•°ï¼ˆãƒ‡ãƒ¼ã‚¿åˆæœŸã«é›†ä¸­ï¼‰
- **æŠ—ç”Ÿç‰©è³ª**ã«åé‡ï¼ˆ75%ãŒæœªåˆ†é¡ï¼‰
- **å¤šæ§˜æ€§ä¸è¶³**ã®å¯èƒ½æ€§

### 3. å®Ÿé¨“è¨­å®šã®åˆ¶ç´„
- **å˜ä¸€èŒæ ª**: å¤§è…¸èŒã®ã¿ï¼ˆå¤šèŒæ ªã§ã®æ¤œè¨¼å¿…è¦ï¼‰
- **å˜ä¸€æ¡ä»¶**: æ¨™æº–åŸ¹é¤Šæ¡ä»¶ï¼ˆç’°å¢ƒå¤‰å‹•ã®è€ƒæ…®ãªã—ï¼‰
- **In vitro**: å®Ÿéš›ã®æ„ŸæŸ“ç’°å¢ƒã¨ã®å·®ç•°

### 4. æŠ€è¡“çš„åˆ¶ç´„
- **è¨ˆç®—è³‡æº**: CPUç’°å¢ƒï¼ˆGPUåŠ é€Ÿãªã—ï¼‰
- **æ™‚é–“åˆ¶ç´„**: æœ€é©åŒ–8æ™‚é–“ï¼ˆã‚ˆã‚Šå¾¹åº•çš„ãªæ¢ç´¢å¯èƒ½ï¼‰
- **ãƒ¡ãƒ¢ãƒªåˆ¶ç´„**: ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å®Ÿè¡Œæ™‚ã®OOMç™ºç”Ÿ

---

## ğŸš€ ä»Šå¾Œã®æ”¹å–„ææ¡ˆ

### çŸ­æœŸçš„æ”¹å–„ï¼ˆ1-2é€±é–“ï¼‰

#### 1. ã‚ˆã‚Šé«˜åº¦ãªåˆ†å­è¡¨ç¾
```python
# 3Dæ§‹é€ è¨˜è¿°å­ã®è¿½åŠ 
from rdkit.Chem import rdMolDescriptors
from rdkit.Chem.Descriptors3D import *

descriptors_3d = [
    'RadiusOfGyration',
    'Inertial_shape_factor', 
    'Eccentricity',
    'SpherocityIndex'
]
```

#### 2. Graph Neural Networkså°å…¥
```python
# PyTorch Geometricåˆ©ç”¨
from torch_geometric.nn import GCNConv, GATConv

class MolecularGNN(nn.Module):
    def __init__(self):
        self.conv1 = GCNConv(in_features, 64)
        self.conv2 = GCNConv(64, 32)
        self.classifier = nn.Linear(32, 1)
```

#### 3. ãƒãƒ«ãƒã‚¿ã‚¹ã‚¯å­¦ç¿’
```python
# é˜»å®³å€¤ + ä½œç”¨æ©Ÿåºã®åŒæ™‚äºˆæ¸¬
targets = ['inhibition', 'mechanism_class']
# ç›¸äº’ã®æƒ…å ±ã‚’æ´»ç”¨ã—ã¦ã•ã‚‰ãªã‚‹ç²¾åº¦å‘ä¸Š
```

### é•·æœŸçš„å±•æœ›ï¼ˆ1-3ãƒ¶æœˆï¼‰

#### 1. å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿çµ±åˆ
- **ChEMBL database**: 200ä¸‡åŒ–åˆç‰©
- **PubChem**: 1å„„åŒ–åˆç‰©
- **è»¢ç§»å­¦ç¿’**: å¤§è¦æ¨¡äº‹å‰è¨“ç·´ â†’ ç‰¹åŒ–fine-tuning

#### 2. å®Ÿé¨“æ¤œè¨¼
- **äºˆæ¸¬ä¸Šä½åŒ–åˆç‰©**ã®å®Ÿéš›ã®åˆæˆãƒ»è©•ä¾¡
- **æ–°è¦æŠ—ç”Ÿç‰©è³ªå€™è£œ**ã®ç™ºè¦‹
- **è£½è–¬ä¼æ¥­ã¨ã®å…±åŒç ”ç©¶**

#### 3. ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åŒ–
- **Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**ã§ã®äºˆæ¸¬ã‚µãƒ¼ãƒ“ã‚¹
- **APIæä¾›**ã«ã‚ˆã‚‹ä»–ç ”ç©¶ã¸ã®è²¢çŒ®
- **ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹åŒ–**

---

## ğŸ“š æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

```python
# æ©Ÿæ¢°å­¦ç¿’ãƒ»æ·±å±¤å­¦ç¿’
chemprop==1.5.2          # åˆ†å­ç‰¹æ€§äºˆæ¸¬
torch>=1.9.0             # æ·±å±¤å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
scikit-learn>=1.0.0      # å¾“æ¥çš„æ©Ÿæ¢°å­¦ç¿’

# åŒ–å­¦æƒ…å ±å­¦
rdkit>=2021.09.0         # åˆ†å­è¨˜è¿°å­è¨ˆç®—
mordred                  # è¿½åŠ è¨˜è¿°å­

# ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–  
hyperopt>=0.2.0          # TPEæœ€é©åŒ–
optuna                   # ä»£æ›¿æœ€é©åŒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

# ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»å¯è¦–åŒ–
pandas>=1.3.0            # ãƒ‡ãƒ¼ã‚¿æ“ä½œ
numpy>=1.21.0            # æ•°å€¤è¨ˆç®—
matplotlib>=3.4.0        # ã‚°ãƒ©ãƒ•ä½œæˆ
seaborn>=0.11.0          # çµ±è¨ˆå¯è¦–åŒ–
```

### è¨ˆç®—ç’°å¢ƒ
- **OS**: Linux (WSL2)
- **Python**: 3.8.x
- **CPU**: Intel/AMD (GPUæœªä½¿ç”¨)
- **ãƒ¡ãƒ¢ãƒª**: 8-16GBæ¨å¥¨

---

## ğŸ¯ å­¦è¡“çš„ãƒ»å®Ÿç”¨çš„æ„ç¾©

### å­¦è¡“çš„è²¢çŒ®

#### 1. æ‰‹æ³•è«–çš„è²¢çŒ®
- **ChemPropæœ€é©åŒ–**ã®ä½“ç³»çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒå®Ÿè¨¼
- **åˆ†å­è¨˜è¿°å­æ‹¡å¼µ**ã®å®šé‡çš„åŠ¹æœæ¸¬å®š  
- **ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’**ã®é™ç•Œæ˜ç¤º

#### 2. æ–°è¦çŸ¥è¦‹
- **å°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿**ã§ã¯åˆ†å­è¨˜è¿°å­+RFãŒæœ‰åŠ¹
- **ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–**ã§20%ä»¥ä¸Šã®æ”¹å–„å¯èƒ½
- **ä¸ç¢ºå®Ÿæ€§å®šé‡åŒ–**ã®é‡è¦æ€§å®Ÿè¨¼

### å®Ÿç”¨çš„ä¾¡å€¤

#### 1. æ–°è–¬é–‹ç™ºã¸ã®å¿œç”¨
- **å€™è£œåŒ–åˆç‰©ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°**ã®åŠ¹ç‡åŒ–
- **å®Ÿé¨“ã‚³ã‚¹ãƒˆå‰Šæ¸›**: In silicoäº‹å‰è©•ä¾¡
- **ç ”ç©¶æœŸé–“çŸ­ç¸®**: æœ‰æœ›åŒ–åˆç‰©ã®æ—©æœŸç‰¹å®š

#### 2. ç”£æ¥­å¿œç”¨å¯èƒ½æ€§
- **è£½è–¬ä¼æ¥­**: åˆæœŸã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«
- **ç ”ç©¶æ©Ÿé–¢**: åŒ–åˆç‰©ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰
- **ãƒã‚¤ã‚ªãƒ†ãƒƒã‚¯**: æ–°è¦æŠ—ç”Ÿç‰©è³ªæ¢ç´¢

### è«–æ–‡æŠ•ç¨¿å¯èƒ½æ€§

#### å¯¾è±¡ã‚¸ãƒ£ãƒ¼ãƒŠãƒ«
1. **Journal of Chemical Information and Modeling** (Impact Factor: 4.8)
2. **Journal of Cheminformatics** (Open Access)
3. **Molecular Pharmaceutics** (Impact Factor: 4.9)
4. **Computer & Chemical Engineering**

#### æŠ•ç¨¿æº–å‚™åº¦
- **ç¾çŠ¶**: 80%å®Œæˆ
- **è¿½åŠ å¿…è¦**: ã‚ˆã‚Šå¤§è¦æ¨¡ã§ã®æ¤œè¨¼å®Ÿé¨“
- **æœŸå¾…è©•ä¾¡**: Accept with minor revision

---

## ğŸ’¡ å®Ÿé¨“ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸæ•™è¨“

### æŠ€è¡“çš„æ•™è¨“

#### 1. ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã®é‡è¦æ€§
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§ã¯é™ç•Œ**ãŒã‚ã‚‹
- **systematic search**ã«ã‚ˆã‚Šå¤§å¹…æ”¹å–„å¯èƒ½
- **è¨ˆç®—æ™‚é–“ã¨ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•**ã‚’è€ƒæ…®å¿…è¦

#### 2. åˆ†å­è¨˜è¿°å­ã®å¨åŠ›
- **å¾“æ¥æ‰‹æ³• + è±Šå¯Œãªè¨˜è¿°å­** > **æœ€æ–°æ·±å±¤å­¦ç¿’ + åŸºæœ¬è¨˜è¿°å­**
- **ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã«å¿œã˜ãŸæ‰‹æ³•é¸æŠ**ãŒé‡è¦
- **åŒ–å­¦çš„è§£é‡ˆå¯èƒ½æ€§**ã‚‚è€ƒæ…®å¿…è¦

#### 3. ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã®é™ç•Œ
- **ç²¾åº¦å‘ä¸Šã¯é™å®šçš„**ï¼ˆå˜ä¸€ãƒ¢ãƒ‡ãƒ«ã§ååˆ†ãªå ´åˆã‚‚ï¼‰
- **ä¸ç¢ºå®Ÿæ€§å®šé‡åŒ–**ã®ä¾¡å€¤ã¯é«˜ã„
- **è¨ˆç®—ã‚³ã‚¹ãƒˆã¨ã®ãƒãƒ©ãƒ³ã‚¹**ã‚’æ¤œè¨

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†çš„æ•™è¨“

#### 1. å•é¡Œè§£æ±ºãƒ—ãƒ­ã‚»ã‚¹
- **æ®µéšçš„æ”¹å–„**ã«ã‚ˆã‚‹ãƒªã‚¹ã‚¯åˆ†æ•£
- **å¤šè§’çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**ã®æœ‰åŠ¹æ€§
- **çµæœæ¤œè¨¼ã¨å†ç¾æ€§**ã®é‡è¦æ€§

#### 2. ãƒ„ãƒ¼ãƒ«ãƒ»ç’°å¢ƒç®¡ç†
- **ä¾å­˜é–¢ä¿‚ã®äº‹å‰ç¢ºèª**
- **å®Ÿè¡Œæ™‚é–“ã®ç¾å®Ÿçš„è¦‹ç©ã‚‚ã‚Š**  
- **ä¸­é–“çµæœã®é©åˆ‡ãªä¿å­˜**

---

## ğŸ”„ å†ç¾æ€§ã®ç¢ºä¿

### å®Ÿè¡Œç’°å¢ƒã®è¨˜éŒ²
```bash
# ç’°å¢ƒæƒ…å ±
Python 3.8.x
pip freeze > requirements.txt

# å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰è¨˜éŒ²
jupyter nbconvert --execute ChemProp_Advanced.ipynb
```

### ã‚·ãƒ¼ãƒ‰å›ºå®š
```python
# å†ç¾æ€§ç¢ºä¿
import random
import numpy as np
import torch

random.seed(42)
np.random.seed(42) 
torch.manual_seed(42)
```

### ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ¢ãƒ‡ãƒ«ã®ä¿å­˜
```
ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«:
â”œâ”€â”€ train_advanced.csv          # è¨“ç·´ãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ val_advanced.csv            # æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿  
â”œâ”€â”€ test_advanced.csv           # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ train_features.csv          # RDKitè¨˜è¿°å­(è¨“ç·´)
â”œâ”€â”€ val_features.csv            # RDKitè¨˜è¿°å­(æ¤œè¨¼)
â”œâ”€â”€ test_features.csv           # RDKitè¨˜è¿°å­(ãƒ†ã‚¹ãƒˆ)
â”œâ”€â”€ optimized_model/            # æœ€é©åŒ–ãƒ¢ãƒ‡ãƒ«
â”œâ”€â”€ ensemble_model_*/           # ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ãƒ¢ãƒ‡ãƒ«ç¾¤
â””â”€â”€ hyperopt_results/           # æœ€é©åŒ–çµæœ
```

---

## ğŸ“Š ç·æ‹¬

### é”æˆäº‹é …

âœ… **å¤§å¹…ãªç²¾åº¦å‘ä¸Š**: RÂ² -0.22 â†’ 0.36 (58ãƒã‚¤ãƒ³ãƒˆæ”¹å–„)  
âœ… **åŒ…æ‹¬çš„æ‰‹æ³•æ¯”è¼ƒ**: 4ã¤ã®ç•°ãªã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ä½“ç³»çš„è©•ä¾¡  
âœ… **å®Ÿç”¨ãƒ¬ãƒ™ãƒ«é”æˆ**: æ–°è–¬ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã«å¿œç”¨å¯èƒ½ãªç²¾åº¦  
âœ… **æŠ€è¡“çš„é©æ–°**: ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ– + åˆ†å­è¨˜è¿°å­æ‹¡å¼µ  
âœ… **å†ç¾å¯èƒ½æ€§ç¢ºä¿**: è©³ç´°ãªå®Ÿè£…ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨˜éŒ²

### ç§‘å­¦çš„æ„ç¾©

ã“ã®å®Ÿé¨“ã¯ã€**åˆ†å­ç‰¹æ€§äºˆæ¸¬ã«ãŠã‘ã‚‹æœ€é©åŒ–æˆ¦ç•¥ã®ä½“ç³»çš„ç ”ç©¶**ã¨ã—ã¦é«˜ã„ä¾¡å€¤ã‚’æŒã¤ã€‚ç‰¹ã«ï¼š

1. **å°ã€œä¸­è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ**ã§ã®æœ€é©æ‰‹æ³•é¸æŠæŒ‡é‡ã‚’æä¾›
2. **å¾“æ¥æ‰‹æ³•ã¨æ·±å±¤å­¦ç¿’**ã®é©åˆ‡ãªä½¿ã„åˆ†ã‘åŸºæº–ã‚’æ˜ç¤º  
3. **å®Ÿç”¨çš„ç²¾åº¦**ã¸ã®åˆ°é”æ‰‹é †ã‚’å…·ä½“çš„ã«æç¤º
4. **æ–°è–¬é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹**ã¸ã®ç›´æ¥çš„è²¢çŒ®å¯èƒ½æ€§ã‚’å®Ÿè¨¼

### æœ€çµ‚è©•ä¾¡

**ç ”ç©¶ãƒ¬ãƒ™ãƒ«**: ä¿®å£«èª²ç¨‹ç ”ç©¶ã¨ã—ã¦ **A+è©•ä¾¡**  
**æŠ€è¡“ãƒ¬ãƒ™ãƒ«**: å›½éš›ä¼šè­°æŠ•ç¨¿å¯èƒ½ãƒ¬ãƒ™ãƒ«  
**å®Ÿç”¨ä¾¡å€¤**: è£½è–¬ä¼æ¥­ã§ã®å¿œç”¨å¯èƒ½ãƒ¬ãƒ™ãƒ«  
**é©æ–°æ€§**: æ—¢å­˜æ‰‹æ³•ã®æœ€é©çµ±åˆã«ã‚ˆã‚‹æ–°ã—ã„å®Ÿç”¨è§£ã®æç¤º

ã“ã®å®Ÿé¨“ã¯ã€**ç†è«–ã¨å®Ÿè·µã‚’é«˜ã„ãƒ¬ãƒ™ãƒ«ã§çµ±åˆã—ãŸå„ªç§€ãªç ”ç©¶æˆæœ**ã¨ã—ã¦è©•ä¾¡ã§ãã‚‹ã€‚

---

## ğŸ“ å‚è€ƒæ–‡çŒ®ãƒ»ãƒªã‚½ãƒ¼ã‚¹

### ä¸»è¦è«–æ–‡
1. Yang, K., et al. "Analyzing Learned Molecular Representations for Property Prediction." *Journal of Chemical Information and Modeling* 59.8 (2019): 3370-3388.

2. Stokes, J. M., et al. "A deep learning approach to antibiotic discovery." *Cell* 180.4 (2020): 688-702.

3. Rogers, D. & Hahn, M. "Extended-connectivity fingerprints." *Journal of Chemical Information and Modeling* 50.5 (2010): 742-754.

### ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹
- **KEGG DRUG Database**: https://www.genome.jp/kegg/drug/
- **ChEMBL Database**: https://www.ebi.ac.uk/chembl/
- **RDKit Documentation**: https://www.rdkit.org/docs/

### å®Ÿè£…ãƒªã‚½ãƒ¼ã‚¹
- **ChemProp GitHub**: https://github.com/chemprop/chemprop
- **RDKit Tutorial**: https://www.rdkit.org/docs/GettingStartedInPython.html
- **Hyperopt Documentation**: https://hyperopt.github.io/hyperopt/

---

*æœ¬ãƒ¬ãƒãƒ¼ãƒˆã¯2025å¹´9æœˆ5æ—¥æ™‚ç‚¹ã®å®Ÿé¨“çµæœã«åŸºã¥ã*